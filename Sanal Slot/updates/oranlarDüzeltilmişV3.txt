<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veren Slot</title>
    <style>
        @media (max-width: 768px) {
            /* KÃ¼Ã§Ã¼k ekranlar iÃ§in dÃ¼zenlemeler */
            .slot {
                width: 60px;
                height: 60px;
                font-size: 36px;
            }
        
            .button {
                font-size: 16px;
                padding: 8px 16px;
            }
        }
        /* CSS stil tanÄ±mlarÄ± burada yer alabilir */
        body {
            font-size: 20px;
            background-color: #f9f9f9;
            color: #333;
        }
        .container {
            text-align: center;
            margin-top: 50px;
        }
        .slot {
            width: 70px;
            height: 70px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            font-size: 40px;
            border: 2px solid #ccc;
            border-radius: 8px;
            margin: 5px;
        }
        #winBox, #balance {
            margin-top: 20px;
            font-size: 24px;
        }
        .rotate-animation {
            animation: spin 1.5s linear;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .button {
            display: inline-block;
            background-color: #007BFF;
            color: #fff;
            border: none;
            padding: 10px 20px;
            font-size: 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Lokum Machine Berko Cash in</h1>
        <label for="betInput">Bahis DeÄŸeri (TL):</label>
        <input type="number" id="betInput" min="1" step="1" value="1">
        <button class="button" onclick="startGame()">Oyuna BaÅŸla / Ã‡evir</button>
        <button class="button" onclick="resetGame()">Oyunu SÄ±fÄ±rla</button>
        <div id="slots"></div>
        <div id="winBox">KazanÃ§: <span id="currentWin">0</span> TL</div>
        <div id="balance">Bakiye: 100 TL</div>
    </div>

    <script>
        const symbols = [
            { symbol: 'ðŸ’', probability: 0.80, payout: 0.03125 },//8 tanesi kazancÄ±n bahis deÄŸerinin 0.25 katÄ±nÄ± verir.
            { symbol: 'ðŸŠ', probability: 0.40, payout: 0.0625 },//8 tanesi kazancÄ±n bahis deÄŸerinin 0.50 katÄ±nÄ± verir.
            { symbol: 'ðŸ‡', probability: 0.25, payout: 0.1 },//8 tanesi kazancÄ±n bahis deÄŸerinin 0.80 katÄ±nÄ± verir.
            { symbol: 'ðŸ“', probability: 0.10, payout: 0.25 },//8 tanesi kazancÄ±n bahis deÄŸerinin 2 katÄ±nÄ± verir.
            { symbol: 'ðŸ‹', probability: 0.0571428571428571, payout: 0.4375 },//8 tanesi kazancÄ±n bahis deÄŸerinin 3.5 katÄ±nÄ± verir.
            { symbol: 'ðŸ””', probability: 0.05, payout: 0.500 },//8 tanesi kazancÄ±n bahis deÄŸerinin 4 katÄ±nÄ± verir.
            { symbol: 'ðŸ’Ž', probability: 0.025, payout: 1 }, //8 tanesi kazancÄ±n bahis deÄŸerinin 8 katÄ±nÄ± verir.
        ];

        const gridRows = 5;
        const gridColumns = 6;
        let isGameRunning = false;
        let balance = 100;
        let bet = 1;
        let winInThisRound = 0;
        let slotData = [];
        let totalWon = 0;

        function startGame() {
            if (isGameRunning) return; // Oyun zaten baÅŸlamÄ±ÅŸsa iÅŸlem yapma
            const betInput = document.getElementById('betInput');
            bet = parseInt(betInput.value);
            if (bet > balance) {
                alert("Bahis miktarÄ± bakiyeden fazla olamaz!");
                return;
            }

            isGameRunning = true;
            balance -= bet; // Bahis miktarÄ±nÄ± bakiyeden dÃ¼ÅŸ
            updateBalance();

            const slotsContainer = document.getElementById('slots');
            slotsContainer.innerHTML = '';
            slotData = [];

            for (let row = 0; row < gridRows; row++) {
                for (let col = 0; col < gridColumns; col++) {
                    const randomSymbol = getRandomSymbol();
                    slotData.push(randomSymbol);
                    const slotElement = document.createElement('div');
                    slotElement.classList.add('slot');
                    slotElement.textContent = randomSymbol;
                    slotsContainer.appendChild(slotElement);
                }
                slotsContainer.appendChild(document.createElement('br'));
            }

            animateSlots(slotData, 0);
        }

        function resetGame() {
            isGameRunning = false;
            winInThisRound = 0;
            const winBox = document.getElementById('winBox');
            winBox.textContent = 'KazanÃ§: 0 TL';
            const slotsContainer = document.getElementById('slots');
            slotsContainer.innerHTML = '';
            balance = 100; // Oyun sÄ±fÄ±rlandÄ±ÄŸÄ±nda bakiyeyi 100 TL'ye ayarla
            updateBalance();
        }

        function getRandomSymbol() {
            const randomIndex = Math.floor(Math.random() * symbols.length);
            return symbols[randomIndex].symbol;
        }

        function animateSlots(slotData, currentIndex) {
            const slotsContainer = document.getElementById('slots');
            const slots = slotsContainer.getElementsByClassName('slot');

            // Ã–nceki dÃ¶nme animasyonunu kaldÄ±r
            for (let i = 0; i < slotData.length; i++) {
                slots[i].classList.remove('rotate-animation');
            }

            // Åžu anki sembolleri ekranda gÃ¶ster
            for (let i = 0; i < slotData.length; i++) {
                slots[i].textContent = slotData[i];
            }

            // Sonraki dÃ¶nme animasyonunu ekle
            const symbol = slotData[currentIndex];
            slots[currentIndex].classList.add('rotate-animation');

            setTimeout(function () {
                slots[currentIndex].classList.remove('rotate-animation');
                currentIndex++;
                if (currentIndex < slotData.length) {
                    animateSlots(slotData, currentIndex);
                } else {
                    checkWin(slotData);
                }
            }, 1.5); // sonra bir sonraki sembole geÃ§
        }

        function checkWin(slotData) {
            let changed = false;
            let symbolsToAnimate = new Set();

            for (let i = 0; i < slotData.length; i++) {
                const symbolToCheck = slotData[i];
                let count = 0;

                for (let j = 0; j < slotData.length; j++) {
                    if (slotData[j] === symbolToCheck) {
                        count++;
                    }
                }

                if (count >= 8) {
                    changed = true;
                    symbolsToAnimate.add(symbolToCheck);
                    winInThisRound += calculateWinAmount(symbolToCheck) * bet;
                }
            }

            const slotsContainer = document.getElementById('slots');
            const slots = slotsContainer.getElementsByClassName('slot');
            for (let i = 0; i < slotData.length; i++) {
                const symbol = slotData[i];
                slots[i].textContent = symbol;

                if (symbolsToAnimate.has(symbol)) {
                    slots[i].classList.add('rotate-animation'); // 8 veya daha fazla sembol varsa animasyonu ekle
                } else {
                    slots[i].classList.remove('rotate-animation'); // DeÄŸilse animasyonu kaldÄ±r
                }
            }

            if (changed) {
                setTimeout(function () {
                    for (let i = 0; i < slotData.length; i++) {
                        const symbol = slotData[i];
                        if (symbolsToAnimate.has(symbol)) {
                            slotData[i] = getRandomSymbol(); // 8 veya daha fazla sembolÃ¼n yerine rastgele sembol yerleÅŸtir
                        }
                    }
                    animateSlots(slotData, 0);
                }, 2000); // 2 saniye sonra yeni dÃ¶nÃ¼ÅŸ baÅŸlasÄ±n
            } else {
                
                isGameRunning = false;
                totalWon += winInThisRound;
                balance += winInThisRound; // KazanÃ§ bakiyeye ekle
                 winInThisRound = 0; // Tur sonundaki kazanÃ§larÄ± sÄ±fÄ±rla
                updateBalance();
                setTimeout(function() {
                    totalWon =0;
                    updateBalance();
                },150 )
                updateCurrentWin();
            }
        }
    
       

        function calculateWinAmount(symbol) {
            const symbolInfo = symbols.find((s) => s.symbol === symbol);
            return symbolInfo ? symbolInfo.payout : 0;
        }

        function updateBalance() {
            const balanceElement = document.getElementById('balance');
            balanceElement.textContent = `Bakiye: ${balance.toFixed(2)} TL`;
        }

        function updateCurrentWin() {
            const currentWinElement = document.getElementById('currentWin');
            currentWinElement.textContent = totalWon.toFixed(2);
        }

        function calculateRTP(symbols) {
            let totalProbability = 0;
            let totalPayout = 0;

            // TÃ¼m sembollerin Ã§Ä±kma olasÄ±lÄ±klarÄ±nÄ± ve Ã¶deme deÄŸerlerini dÃ¶ngÃ¼yle toplarÄ±z
            for (const symbol of symbols) {
                totalProbability += symbol.probability;
                totalPayout += symbol.payout * symbol.probability;
            }

            // RTP oranÄ±nÄ± hesaplarÄ±z ve yÃ¼zde olarak dÃ¶ndÃ¼rÃ¼rÃ¼z
            const rtp = (totalPayout / totalProbability) * 100;
            return rtp.toFixed(2); // OndalÄ±k kÄ±smÄ± iki basamakla sÄ±nÄ±rlarÄ±z
        }

        const rtpValue = calculateRTP(symbols);
        console.log("RTP OranÄ±: %", rtpValue);


       
    </script>
</body>
</html>

